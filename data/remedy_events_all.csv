column,column_rel,formula,viewname
agent_id,,source table,gns_vwfm_agentadherencetotal_v
agentname,,source table,gns_vwfm_agentadherencetotal_v
assigned_group_change,assigned_group,"trim(regexp_replace(assigned_group, 'assigned group:|[\(\)]', ''))",csa_tmp_inc_evnt_rmdy2110_v4
assigned_group,assigned_group_position,cast(case when assigned_group_position = 0 then null else regexp_substr(log_entries '[^\n]+' case when assigned_group_position = 0 then 1 else assigned_group_position end 1) end,csa_tmp_inc_evnt_rmdy2110_v3
assigned_support_company_change,assigned_support_company,"trim(regexp_replace(assigned_support_company, 'assigned support company:|[0-9]|[\(\)]', ''))",csa_tmp_inc_evnt_rmdy2110_v4
assigned_support_company,assigned_support_company_position,cast(case when assigned_support_company_position = 0 then null else regexp_substr(log_entries '[^\n]+' case when assigned_support_company_position = 0 then 1 else assigned_support_company_position end 1) end,csa_tmp_inc_evnt_rmdy2110_v3
assignee_change_date,assignee_change,max(case when assignee_change <> '<blank>' or assignee_change is null then null else audit_date_local end) over ( partition by incident_key order by audit_date_local rows between unbounded preceding and current row ),csa_tmp_inc_evnt_rmdy2110_v5
assignee_change_date,audit_date_local,max(case when assignee_change <> '<blank>' or assignee_change is null then null else audit_date_local end) over ( partition by incident_key order by audit_date_local rows between unbounded preceding and current row ),csa_tmp_inc_evnt_rmdy2110_v5
assignee_change_date,incident_key,max(case when assignee_change <> '<blank>' or assignee_change is null then null else audit_date_local end) over ( partition by incident_key order by audit_date_local rows between unbounded preceding and current row ),csa_tmp_inc_evnt_rmdy2110_v5
assignee_change,assignee,"trim(regexp_replace(assignee, 'assignee:|[0-9]|[\(\)]', ''))",csa_tmp_inc_evnt_rmdy2110_v4
assignee,assignee_position,cast(case when assignee_position = 0 then null else regexp_substr(log_entries '[^\n]+' case when assignee_position = 0 then 1 else assignee_position end 1) end,csa_tmp_inc_evnt_rmdy2110_v3
audit_date_aest,audit_date,convert_timezone ('utc' 'australia/sydney' audit_date),csa_tmp_inc_evnt_rmdy2110_v2
audit_date_local,timezone_city,convert_timezone('utc' 'australia/' || timezone_city t1.audit_date),csa_tmp_inc_evnt_rmdy2110_v2
audit_date_utc,audit_date,audit_date,csa_tmp_inc_evnt_rmdy2110_v3
incident_accepted_ts_aest,audit_date_aest,case when incident_status = 'in progress' and incident_reason = 'accepted' then audit_date_aest else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_accepted_ts_aest,incident_reason,case when incident_status = 'in progress' and incident_reason = 'accepted' then audit_date_aest else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_accepted_ts_aest,incident_status,case when incident_status = 'in progress' and incident_reason = 'accepted' then audit_date_aest else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_accepted_ts_local,audit_date_local,case when incident_status = 'in progress' and incident_reason = 'accepted' then audit_date_local else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_accepted_ts_local,incident_reason,case when incident_status = 'in progress' and incident_reason = 'accepted' then audit_date_local else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_accepted_ts_local,incident_status,case when incident_status = 'in progress' and incident_reason = 'accepted' then audit_date_local else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_access_seeker_update_ts_aest,audit_date_aest,case when otd_milestone = 'access seeker update' then audit_date_aest else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_access_seeker_update_ts_aest,otd_milestone,case when otd_milestone = 'access seeker update' then audit_date_aest else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_assigned_group_ts_aest,assigned_group_change,"( case when nvl(assigned_group_change, '<blank>') <> '<blank>' then audit_date_aest else null end )",csa_tmp_inc_evnt_rmdy2110_v4
incident_assigned_group_ts_aest,audit_date_aest,"( case when nvl(assigned_group_change, '<blank>') <> '<blank>' then audit_date_aest else null end )",csa_tmp_inc_evnt_rmdy2110_v4
incident_assigned_group_ts_local,assigned_group_change,"( case when nvl(assigned_group_change, '<blank>') <> '<blank>' then audit_date_local else null end )",csa_tmp_inc_evnt_rmdy2110_v4
incident_assigned_group_ts_local,audit_date_local,"( case when nvl(assigned_group_change, '<blank>') <> '<blank>' then audit_date_local else null end )",csa_tmp_inc_evnt_rmdy2110_v4
incident_closed_ts_aest,audit_date_aest,( case when incident_status_change = 'closed' then audit_date_aest else null end ),csa_tmp_inc_evnt_rmdy2110_v5
incident_closed_ts_aest,incident_status_change,( case when incident_status_change = 'closed' then audit_date_aest else null end ),csa_tmp_inc_evnt_rmdy2110_v5
incident_closed_ts_local,audit_date_local,( case when incident_status_change = 'closed' then audit_date_local else null end ),csa_tmp_inc_evnt_rmdy2110_v5
incident_closed_ts_local,incident_status_change,( case when incident_status_change = 'closed' then audit_date_local else null end ),csa_tmp_inc_evnt_rmdy2110_v5
incident_closed_ts_utc,audit_date_utc,( case when incident_status_change = 'closed' then audit_date_utc else null end ),csa_tmp_inc_evnt_rmdy2110_v5
incident_closed_ts_utc,incident_status_change,( case when incident_status_change = 'closed' then audit_date_utc else null end ),csa_tmp_inc_evnt_rmdy2110_v5
incident_dispatched_ts_aest,audit_date_aest,case when incident_milestone_1 = 'dispatched' then audit_date_aest else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_dispatched_ts_aest,incident_milestone_1,case when incident_milestone_1 = 'dispatched' then audit_date_aest else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_dispatched_ts_local,audit_date_local,case when incident_milestone_1 = 'dispatched' then audit_date_local else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_dispatched_ts_local,incident_milestone_1,case when incident_milestone_1 = 'dispatched' then audit_date_local else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_industry_status_change,incident_industry_status,"trim(regexp_replace(incident_industry_status, 'industry status:', ''))",csa_tmp_inc_evnt_rmdy2110_v4
incident_pended_ts_aest,audit_date_aest,case when incident_milestone_1 = 'pending' then audit_date_aest else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_pended_ts_aest,incident_milestone_1,case when incident_milestone_1 = 'pending' then audit_date_aest else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_pended_ts_local,audit_date_local,case when incident_milestone_1 = 'pending' then audit_date_local else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_pended_ts_local,incident_milestone_1,case when incident_milestone_1 = 'pending' then audit_date_local else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_reason_change,incident_reason,"trim(regexp_replace(incident_reason, 'status_reason: |[0-9]|[\(\)]', ''))",csa_tmp_inc_evnt_rmdy2110_v4
incident_resolution_rejected_ts_aest,audit_date_aest,case when otd_milestone = 'resolution rejected' then audit_date_aest else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_resolution_rejected_ts_aest,otd_milestone,case when otd_milestone = 'resolution rejected' then audit_date_aest else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_resolved_ts_aest,audit_date_aest,case when otd_milestone = 'resolved' then audit_date_aest else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_resolved_ts_aest,otd_milestone,case when otd_milestone = 'resolved' then audit_date_aest else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_resolved_ts_local,audit_date_local,case when otd_milestone = 'resolved' then audit_date_local else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_resolved_ts_local,otd_milestone,case when otd_milestone = 'resolved' then audit_date_local else null end,csa_tmp_inc_evnt_rmdy2110_v5
incident_status_change,incident_status_1,"trim(regexp_replace(incident_status_1, 'status:|[0-9]|[\(\)]', ''))",csa_tmp_inc_evnt_rmdy2110_v4
incident_status_ts_aest,audit_date_aest,"( case when nvl(incident_status_change, '<blank>') <> '<blank>' then audit_date_aest else null end )",csa_tmp_inc_evnt_rmdy2110_v4
incident_status_ts_aest,incident_status_change,"( case when nvl(incident_status_change, '<blank>') <> '<blank>' then audit_date_aest else null end )",csa_tmp_inc_evnt_rmdy2110_v4
incident_status_ts_local,audit_date_local,"( case when nvl(incident_status_change, '<blank>') <> '<blank>' then audit_date_local else null end )",csa_tmp_inc_evnt_rmdy2110_v4
incident_status_ts_local,incident_status_change,"( case when nvl(incident_status_change, '<blank>') <> '<blank>' then audit_date_local else null end )",csa_tmp_inc_evnt_rmdy2110_v4
incident_status,incident_key,"nvl(incident_status_change, min(incident_status_change) over ( partition by incident_key ,incident_status_null_seq ))",csa_tmp_inc_evnt_rmdy2110_v5
incident_status,incident_status_change,"nvl(incident_status_change, min(incident_status_change) over ( partition by incident_key ,incident_status_null_seq ))",csa_tmp_inc_evnt_rmdy2110_v5
incident_status,incident_status_null_seq,"nvl(incident_status_change, min(incident_status_change) over ( partition by incident_key ,incident_status_null_seq ))",csa_tmp_inc_evnt_rmdy2110_v5
industry_sub_status_change,industry_sub_status,"trim(regexp_replace(industry_sub_status, 'industry sub status:|[0-9]|[\(\)]', ''))",csa_tmp_inc_evnt_rmdy2110_v4
interaction_milestone,incident_industry_status_change,"case when incident_industry_status_change = 'acknowledged' then 'new' when incident_reason_change = 'resolution rejected by a.s' then 'resolution rejected' when incident_reason_change = 'support contact hold' or industry_sub_status_change = 'held' or incident_industry_status_change = 'held' or incident_reason_change = 'request' then 'on hold' --'support contact hold' when incident_reason_change = 'dispatched' then 'dispatched' when /*incident_industry_status_change industry_sub_status_change*/ incident_status_change = 'pending' then 'pending' when /*incident_status_change incident_industry_status_change*/ incident_status_change = 'resolved' then 'resolved' when incident_industry_status_change = 'inprogress' and assignee_change like 'shift handover%' then 'acknowledged' when ( assignee_change = '<blank>' or incident_status_change = 'assigned' ) and assigned_support_company_change = 'nbnco operations' and user_x in ( 'aomaster' ,'aomaster1' ,'fuseadmin' ) then 'inbound transfer' when assignee_change = '<blank>' and user_x in ('fuseadmin') then 'as return' when assignee_change like 'shift handover%' and user_x in ('fuseadmin') then 'as return' when assigned_group_change in ( 'nsoc' ,'fttp pa assurance tier 1' ,'hfc pa assurance tier 1' ,'csc-hfc' ,'fttx assurance tier1' ,'fttx pa assurance tier 1' ,'nhur - work rights' ,'fttp assurance jeopardy tier 1' ,'hfc assurance jeopardy tier 1' ,'fttx assurance jeopardy tier 1' ,'fttc assurae tier1' ,'fttp assurance tier 2' ,'fttx assurance tier 2' ,'hfc assurance tier 2' ) then 'inbound transfer' when assigned_group_change is not null or assigned_support_company_change in ('optus nap optus networks pvt. ltd.') then 'outbound transfer' else null end",csa_tmp_inc_evnt_rmdy2110_v5
interaction_milestone,incident_reason_change,"case when incident_industry_status_change = 'acknowledged' then 'new' when incident_reason_change = 'resolution rejected by a.s' then 'resolution rejected' when incident_reason_change = 'support contact hold' or industry_sub_status_change = 'held' or incident_industry_status_change = 'held' or incident_reason_change = 'request' then 'on hold' --'support contact hold' when incident_reason_change = 'dispatched' then 'dispatched' when /*incident_industry_status_change industry_sub_status_change*/ incident_status_change = 'pending' then 'pending' when /*incident_status_change incident_industry_status_change*/ incident_status_change = 'resolved' then 'resolved' when incident_industry_status_change = 'inprogress' and assignee_change like 'shift handover%' then 'acknowledged' when ( assignee_change = '<blank>' or incident_status_change = 'assigned' ) and assigned_support_company_change = 'nbnco operations' and user_x in ( 'aomaster' ,'aomaster1' ,'fuseadmin' ) then 'inbound transfer' when assignee_change = '<blank>' and user_x in ('fuseadmin') then 'as return' when assignee_change like 'shift handover%' and user_x in ('fuseadmin') then 'as return' when assigned_group_change in ( 'nsoc' ,'fttp pa assurance tier 1' ,'hfc pa assurance tier 1' ,'csc-hfc' ,'fttx assurance tier1' ,'fttx pa assurance tier 1' ,'nhur - work rights' ,'fttp assurance jeopardy tier 1' ,'hfc assurance jeopardy tier 1' ,'fttx assurance jeopardy tier 1' ,'fttc assurae tier1' ,'fttp assurance tier 2' ,'fttx assurance tier 2' ,'hfc assurance tier 2' ) then 'inbound transfer' when assigned_group_change is not null or assigned_support_company_change in ('optus nap optus networks pvt. ltd.') then 'outbound transfer' else null end",csa_tmp_inc_evnt_rmdy2110_v5
interaction_milestone,industry_sub_status_change,"case when incident_industry_status_change = 'acknowledged' then 'new' when incident_reason_change = 'resolution rejected by a.s' then 'resolution rejected' when incident_reason_change = 'support contact hold' or industry_sub_status_change = 'held' or incident_industry_status_change = 'held' or incident_reason_change = 'request' then 'on hold' --'support contact hold' when incident_reason_change = 'dispatched' then 'dispatched' when /*incident_industry_status_change industry_sub_status_change*/ incident_status_change = 'pending' then 'pending' when /*incident_status_change incident_industry_status_change*/ incident_status_change = 'resolved' then 'resolved' when incident_industry_status_change = 'inprogress' and assignee_change like 'shift handover%' then 'acknowledged' when ( assignee_change = '<blank>' or incident_status_change = 'assigned' ) and assigned_support_company_change = 'nbnco operations' and user_x in ( 'aomaster' ,'aomaster1' ,'fuseadmin' ) then 'inbound transfer' when assignee_change = '<blank>' and user_x in ('fuseadmin') then 'as return' when assignee_change like 'shift handover%' and user_x in ('fuseadmin') then 'as return' when assigned_group_change in ( 'nsoc' ,'fttp pa assurance tier 1' ,'hfc pa assurance tier 1' ,'csc-hfc' ,'fttx assurance tier1' ,'fttx pa assurance tier 1' ,'nhur - work rights' ,'fttp assurance jeopardy tier 1' ,'hfc assurance jeopardy tier 1' ,'fttx assurance jeopardy tier 1' ,'fttc assurae tier1' ,'fttp assurance tier 2' ,'fttx assurance tier 2' ,'hfc assurance tier 2' ) then 'inbound transfer' when assigned_group_change is not null or assigned_support_company_change in ('optus nap optus networks pvt. ltd.') then 'outbound transfer' else null end",csa_tmp_inc_evnt_rmdy2110_v5
interaction_sequence_type,interaction_milestone,"case when interaction_milestone = prev_interaction_milestone and interaction_milestone in ( 'pending' ,'dispatched' ) then null when interaction_milestone = 'new' and interaction_sequence = 0 then 'incident created' when interaction_milestone is not null and interaction_milestone not in ( 'acknowledged' ,'in progress' ,'support contact hold' ) and interaction_sequence = 1 then 'first action' when interaction_milestone is not null and interaction_milestone not in ( 'acknowledged' ,'in progress' ,'support contact hold' ) and interaction_sequence > 1 then 'subsequent action' -----end else null end",csa_tmp_inc_evnt_rmdy2110_v6
interaction_sequence_type,interaction_sequence,"case when interaction_milestone = prev_interaction_milestone and interaction_milestone in ( 'pending' ,'dispatched' ) then null when interaction_milestone = 'new' and interaction_sequence = 0 then 'incident created' when interaction_milestone is not null and interaction_milestone not in ( 'acknowledged' ,'in progress' ,'support contact hold' ) and interaction_sequence = 1 then 'first action' when interaction_milestone is not null and interaction_milestone not in ( 'acknowledged' ,'in progress' ,'support contact hold' ) and interaction_sequence > 1 then 'subsequent action' -----end else null end",csa_tmp_inc_evnt_rmdy2110_v6
interaction_sequence_type,prev_interaction_milestone,"case when interaction_milestone = prev_interaction_milestone and interaction_milestone in ( 'pending' ,'dispatched' ) then null when interaction_milestone = 'new' and interaction_sequence = 0 then 'incident created' when interaction_milestone is not null and interaction_milestone not in ( 'acknowledged' ,'in progress' ,'support contact hold' ) and interaction_sequence = 1 then 'first action' when interaction_milestone is not null and interaction_milestone not in ( 'acknowledged' ,'in progress' ,'support contact hold' ) and interaction_sequence > 1 then 'subsequent action' -----end else null end",csa_tmp_inc_evnt_rmdy2110_v6
interaction_sequence,audit_date_local,case when next_audit_date_local_ts = audit_date_local and interaction_milestone is null then null else --need to move this down dense_rank() over ( partition by incident_key order by prev_interaction_seq_audit_date_local nulls first ) - 1 end,csa_tmp_inc_evnt_rmdy2110_v6
interaction_sequence,interaction_milestone,case when next_audit_date_local_ts = audit_date_local and interaction_milestone is null then null else --need to move this down dense_rank() over ( partition by incident_key order by prev_interaction_seq_audit_date_local nulls first ) - 1 end,csa_tmp_inc_evnt_rmdy2110_v6
interaction_sequence,next_audit_date_local_ts,case when next_audit_date_local_ts = audit_date_local and interaction_milestone is null then null else --need to move this down dense_rank() over ( partition by incident_key order by prev_interaction_seq_audit_date_local nulls first ) - 1 end,csa_tmp_inc_evnt_rmdy2110_v6
kaizen_l2_process_new,kaizen_l2_process_test,case when kaizen_l2_process_test like '%d&a%' then 'd&a' when kaizen_l2_process_test like '%rsp%' then 'rsp' when kaizen_l2_process_test like '%r&c%' then 'r&c' else kaizen_l2_process_test end,csa_tmp_inc_evnt_rmdy2110_v7
kaizen_l2_process_test,interaction_milestone,"case when interaction_milestone = 'resolved' and upper(previous_assigned_group) like ('%ericsson%') then 'r&c' when interaction_milestone in ('inbound transfer') and user_x in ('fuseadmin') then 'rsp' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'pending' then 'rsp' when interaction_milestone in ('inbound transfer') and user_x in ( 'aomaster' ,'aomaster1' ) then 'rsp' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'pending' and res_cat_3 in ( 'as - no response received' ,'addressing issue' ,'no fault found - no truck roll required' ,'no fault found - working as designed' ,'rsp disconnected service' ,'as - response received' ,'as - created in error' ,'potential fault cleared' ,'nbnco - provisioning error - restoration' ,'nbnco - remote reconfigure' ,'nbnco - remote reset/reload/restart' ) then 'rsp' when interaction_milestone in ( 'as return' ,'resolution rejected' ) then 'rsp' when incident_interaction_first_dispatched_ts_local is null and interaction_milestone in ( 'as return' ,'resolution rejected' ) then 'rsp' when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ( 'as return' ,'resolution rejected' ) then 'rsp' when interaction_milestone = 'outbound transfer' and user_x in ('ar_escalator') then 'non-csa 1' when nvl(previous_assigned_group, '') in ('') and assigned_group in ('generic resource automation') then 'non-csa 2aa' when interaction_sequence_type in ( 'first action' ,'subsequent action' ) and user_x in ( 'aomaster' ,'aomaster1' ,'ar_escalator' ,'fuseadmin' ,'svc_rem_prd_tndpass' ) then 'non-csa 3' when nbn_technology = 'fttp' and prev_interaction_milestone in ( 'dispatched' ,'outbound transfer' ) then 'r&c' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'dispatched' then 'r&c 1' when interaction_milestone = 'pending' and prev_interaction_milestone = 'dispatched' then 'r&c 2' when interaction_milestone = 'pending' and upper(previous_assigned_group) not in ( 'nsoc' ,'fttp pa assurance tier 1' ,'hfc pa assurance tier 1' ,'csc-hfc ' ,'fttx pa assurance tier 1' ,'nhur - work rights' ,'fttx assurance tier1' ,'fttp assurance jeopardy tier 1' ,'hfc assurance jeopardy tier 1' ,'fttx assurance jeopardy tier 1' ) then 'non-csa 5' when interaction_milestone = 'pending' then 'dp&a' --- 'rule 1 – dp&a - 21/08/2017' --when interaction_milestone= 'inbound transfer' and upper(previous_assigned_group) like ('%ericsson%managed%') then 'rule added 15/8/2017 3 ericsson r&c' when interaction_milestone = 'outbound transfer' and upper(previous_assigned_group) in ( 'nsoc' ,'fttp pa assurance tier 1' ,'hfc pa assurance tier 1' ,'csc-hfc ' ,'fttx pa assurance tier 1' ,'nhur - work rights' ,'fttx assurance tier1' ,'fttp assurance jeopardy tier 1' ,'hfc assurance jeopardy tier 1' ,'fttx assurance jeopardy tier 1' ) then 'd&a' --when interaction_milestone in ( 'resolved' ) and prev_interaction_milestone in ('resolution rejected','pending') and upper(previous_assigned_group) like ('%ericsson%managed%') then 'rule ericsson-r&c' --when interaction_milestone in ('inbound transfer') then 'non-csa-2' when interaction_milestone = 'dispatched' then 'd&a' when interaction_milestone = 'outbound transfer' and prev_interaction_milestone in ( 'as return' ,'new' ,'outbound transfer' ,'pending' ,'resolution rejected' ) then 'd&a' when interaction_milestone = 'outbound transfer' /*and prev_interaction_milestone in ('in progress','inbound transfer')*/ then 'non-csa 3' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'resolution rejected' then 'd&a' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'automation queue' then 'r&c 3' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'pending' and res_cat_3 in ( 'truck roll - cabling replaced' ,'truck roll - reconfigure' ,'truck roll - replaced' ,'truck roll - cabling re-terminated/ respliced' ,'as - end user unavailable' ,'truck roll - cabling refitted' ) then 'r&c 4' when incident_interaction_first_resolved_ts_local < incident_interaction_first_dispatched_ts_local and incident_interaction_first_resolved_ts_local is not null and incident_interaction_first_dispatched_ts_local is not null then 'd&a' when incident_interaction_first_dispatched_ts_local is null and interaction_milestone in ( 'inbound transfer' ,'new' ,/*'pending',*/ 'resolved' ) then 'd&a' --when incident_interaction_first_dispatched_ts_local is null and interaction_milestone in ('outbound transfer') then 'rule 4- non-csa' when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ( 'in progress' ,'inbound transfer' ,'new' ) then 'd&a' ---when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ('outbound transfer') then 'rule 5/6- non-csa' when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ('resolved') then 'r&c' --when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ('pending') and audit_date_local > incident_interaction_first_dispatched_ts_local then 'rule 5- r&c' --when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ('pending') and audit_date_local <= incident_interaction_first_dispatched_ts_local then 'rule 6- d&a' when interaction_milestone in ('inbound transfer') then 'non-csa-4' else 'no l2 process' end as kaizen_l2_process_new",csa_tmp_inc_evnt_rmdy2110_v6
kaizen_l2_process_test,prev_interaction_milestone,"case when interaction_milestone = 'resolved' and upper(previous_assigned_group) like ('%ericsson%') then 'r&c' when interaction_milestone in ('inbound transfer') and user_x in ('fuseadmin') then 'rsp' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'pending' then 'rsp' when interaction_milestone in ('inbound transfer') and user_x in ( 'aomaster' ,'aomaster1' ) then 'rsp' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'pending' and res_cat_3 in ( 'as - no response received' ,'addressing issue' ,'no fault found - no truck roll required' ,'no fault found - working as designed' ,'rsp disconnected service' ,'as - response received' ,'as - created in error' ,'potential fault cleared' ,'nbnco - provisioning error - restoration' ,'nbnco - remote reconfigure' ,'nbnco - remote reset/reload/restart' ) then 'rsp' when interaction_milestone in ( 'as return' ,'resolution rejected' ) then 'rsp' when incident_interaction_first_dispatched_ts_local is null and interaction_milestone in ( 'as return' ,'resolution rejected' ) then 'rsp' when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ( 'as return' ,'resolution rejected' ) then 'rsp' when interaction_milestone = 'outbound transfer' and user_x in ('ar_escalator') then 'non-csa 1' when nvl(previous_assigned_group, '') in ('') and assigned_group in ('generic resource automation') then 'non-csa 2aa' when interaction_sequence_type in ( 'first action' ,'subsequent action' ) and user_x in ( 'aomaster' ,'aomaster1' ,'ar_escalator' ,'fuseadmin' ,'svc_rem_prd_tndpass' ) then 'non-csa 3' when nbn_technology = 'fttp' and prev_interaction_milestone in ( 'dispatched' ,'outbound transfer' ) then 'r&c' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'dispatched' then 'r&c 1' when interaction_milestone = 'pending' and prev_interaction_milestone = 'dispatched' then 'r&c 2' when interaction_milestone = 'pending' and upper(previous_assigned_group) not in ( 'nsoc' ,'fttp pa assurance tier 1' ,'hfc pa assurance tier 1' ,'csc-hfc ' ,'fttx pa assurance tier 1' ,'nhur - work rights' ,'fttx assurance tier1' ,'fttp assurance jeopardy tier 1' ,'hfc assurance jeopardy tier 1' ,'fttx assurance jeopardy tier 1' ) then 'non-csa 5' when interaction_milestone = 'pending' then 'dp&a' --- 'rule 1 – dp&a - 21/08/2017' --when interaction_milestone= 'inbound transfer' and upper(previous_assigned_group) like ('%ericsson%managed%') then 'rule added 15/8/2017 3 ericsson r&c' when interaction_milestone = 'outbound transfer' and upper(previous_assigned_group) in ( 'nsoc' ,'fttp pa assurance tier 1' ,'hfc pa assurance tier 1' ,'csc-hfc ' ,'fttx pa assurance tier 1' ,'nhur - work rights' ,'fttx assurance tier1' ,'fttp assurance jeopardy tier 1' ,'hfc assurance jeopardy tier 1' ,'fttx assurance jeopardy tier 1' ) then 'd&a' --when interaction_milestone in ( 'resolved' ) and prev_interaction_milestone in ('resolution rejected','pending') and upper(previous_assigned_group) like ('%ericsson%managed%') then 'rule ericsson-r&c' --when interaction_milestone in ('inbound transfer') then 'non-csa-2' when interaction_milestone = 'dispatched' then 'd&a' when interaction_milestone = 'outbound transfer' and prev_interaction_milestone in ( 'as return' ,'new' ,'outbound transfer' ,'pending' ,'resolution rejected' ) then 'd&a' when interaction_milestone = 'outbound transfer' /*and prev_interaction_milestone in ('in progress','inbound transfer')*/ then 'non-csa 3' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'resolution rejected' then 'd&a' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'automation queue' then 'r&c 3' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'pending' and res_cat_3 in ( 'truck roll - cabling replaced' ,'truck roll - reconfigure' ,'truck roll - replaced' ,'truck roll - cabling re-terminated/ respliced' ,'as - end user unavailable' ,'truck roll - cabling refitted' ) then 'r&c 4' when incident_interaction_first_resolved_ts_local < incident_interaction_first_dispatched_ts_local and incident_interaction_first_resolved_ts_local is not null and incident_interaction_first_dispatched_ts_local is not null then 'd&a' when incident_interaction_first_dispatched_ts_local is null and interaction_milestone in ( 'inbound transfer' ,'new' ,/*'pending',*/ 'resolved' ) then 'd&a' --when incident_interaction_first_dispatched_ts_local is null and interaction_milestone in ('outbound transfer') then 'rule 4- non-csa' when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ( 'in progress' ,'inbound transfer' ,'new' ) then 'd&a' ---when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ('outbound transfer') then 'rule 5/6- non-csa' when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ('resolved') then 'r&c' --when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ('pending') and audit_date_local > incident_interaction_first_dispatched_ts_local then 'rule 5- r&c' --when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ('pending') and audit_date_local <= incident_interaction_first_dispatched_ts_local then 'rule 6- d&a' when interaction_milestone in ('inbound transfer') then 'non-csa-4' else 'no l2 process' end as kaizen_l2_process_new",csa_tmp_inc_evnt_rmdy2110_v6
kaizen_l2_process_test,previous_assigned_group,"case when interaction_milestone = 'resolved' and upper(previous_assigned_group) like ('%ericsson%') then 'r&c' when interaction_milestone in ('inbound transfer') and user_x in ('fuseadmin') then 'rsp' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'pending' then 'rsp' when interaction_milestone in ('inbound transfer') and user_x in ( 'aomaster' ,'aomaster1' ) then 'rsp' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'pending' and res_cat_3 in ( 'as - no response received' ,'addressing issue' ,'no fault found - no truck roll required' ,'no fault found - working as designed' ,'rsp disconnected service' ,'as - response received' ,'as - created in error' ,'potential fault cleared' ,'nbnco - provisioning error - restoration' ,'nbnco - remote reconfigure' ,'nbnco - remote reset/reload/restart' ) then 'rsp' when interaction_milestone in ( 'as return' ,'resolution rejected' ) then 'rsp' when incident_interaction_first_dispatched_ts_local is null and interaction_milestone in ( 'as return' ,'resolution rejected' ) then 'rsp' when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ( 'as return' ,'resolution rejected' ) then 'rsp' when interaction_milestone = 'outbound transfer' and user_x in ('ar_escalator') then 'non-csa 1' when nvl(previous_assigned_group, '') in ('') and assigned_group in ('generic resource automation') then 'non-csa 2aa' when interaction_sequence_type in ( 'first action' ,'subsequent action' ) and user_x in ( 'aomaster' ,'aomaster1' ,'ar_escalator' ,'fuseadmin' ,'svc_rem_prd_tndpass' ) then 'non-csa 3' when nbn_technology = 'fttp' and prev_interaction_milestone in ( 'dispatched' ,'outbound transfer' ) then 'r&c' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'dispatched' then 'r&c 1' when interaction_milestone = 'pending' and prev_interaction_milestone = 'dispatched' then 'r&c 2' when interaction_milestone = 'pending' and upper(previous_assigned_group) not in ( 'nsoc' ,'fttp pa assurance tier 1' ,'hfc pa assurance tier 1' ,'csc-hfc ' ,'fttx pa assurance tier 1' ,'nhur - work rights' ,'fttx assurance tier1' ,'fttp assurance jeopardy tier 1' ,'hfc assurance jeopardy tier 1' ,'fttx assurance jeopardy tier 1' ) then 'non-csa 5' when interaction_milestone = 'pending' then 'dp&a' --- 'rule 1 – dp&a - 21/08/2017' --when interaction_milestone= 'inbound transfer' and upper(previous_assigned_group) like ('%ericsson%managed%') then 'rule added 15/8/2017 3 ericsson r&c' when interaction_milestone = 'outbound transfer' and upper(previous_assigned_group) in ( 'nsoc' ,'fttp pa assurance tier 1' ,'hfc pa assurance tier 1' ,'csc-hfc ' ,'fttx pa assurance tier 1' ,'nhur - work rights' ,'fttx assurance tier1' ,'fttp assurance jeopardy tier 1' ,'hfc assurance jeopardy tier 1' ,'fttx assurance jeopardy tier 1' ) then 'd&a' --when interaction_milestone in ( 'resolved' ) and prev_interaction_milestone in ('resolution rejected','pending') and upper(previous_assigned_group) like ('%ericsson%managed%') then 'rule ericsson-r&c' --when interaction_milestone in ('inbound transfer') then 'non-csa-2' when interaction_milestone = 'dispatched' then 'd&a' when interaction_milestone = 'outbound transfer' and prev_interaction_milestone in ( 'as return' ,'new' ,'outbound transfer' ,'pending' ,'resolution rejected' ) then 'd&a' when interaction_milestone = 'outbound transfer' /*and prev_interaction_milestone in ('in progress','inbound transfer')*/ then 'non-csa 3' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'resolution rejected' then 'd&a' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'automation queue' then 'r&c 3' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'pending' and res_cat_3 in ( 'truck roll - cabling replaced' ,'truck roll - reconfigure' ,'truck roll - replaced' ,'truck roll - cabling re-terminated/ respliced' ,'as - end user unavailable' ,'truck roll - cabling refitted' ) then 'r&c 4' when incident_interaction_first_resolved_ts_local < incident_interaction_first_dispatched_ts_local and incident_interaction_first_resolved_ts_local is not null and incident_interaction_first_dispatched_ts_local is not null then 'd&a' when incident_interaction_first_dispatched_ts_local is null and interaction_milestone in ( 'inbound transfer' ,'new' ,/*'pending',*/ 'resolved' ) then 'd&a' --when incident_interaction_first_dispatched_ts_local is null and interaction_milestone in ('outbound transfer') then 'rule 4- non-csa' when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ( 'in progress' ,'inbound transfer' ,'new' ) then 'd&a' ---when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ('outbound transfer') then 'rule 5/6- non-csa' when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ('resolved') then 'r&c' --when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ('pending') and audit_date_local > incident_interaction_first_dispatched_ts_local then 'rule 5- r&c' --when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ('pending') and audit_date_local <= incident_interaction_first_dispatched_ts_local then 'rule 6- d&a' when interaction_milestone in ('inbound transfer') then 'non-csa-4' else 'no l2 process' end as kaizen_l2_process_new",csa_tmp_inc_evnt_rmdy2110_v6
kaizen_l2_process_test,user_x,"case when interaction_milestone = 'resolved' and upper(previous_assigned_group) like ('%ericsson%') then 'r&c' when interaction_milestone in ('inbound transfer') and user_x in ('fuseadmin') then 'rsp' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'pending' then 'rsp' when interaction_milestone in ('inbound transfer') and user_x in ( 'aomaster' ,'aomaster1' ) then 'rsp' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'pending' and res_cat_3 in ( 'as - no response received' ,'addressing issue' ,'no fault found - no truck roll required' ,'no fault found - working as designed' ,'rsp disconnected service' ,'as - response received' ,'as - created in error' ,'potential fault cleared' ,'nbnco - provisioning error - restoration' ,'nbnco - remote reconfigure' ,'nbnco - remote reset/reload/restart' ) then 'rsp' when interaction_milestone in ( 'as return' ,'resolution rejected' ) then 'rsp' when incident_interaction_first_dispatched_ts_local is null and interaction_milestone in ( 'as return' ,'resolution rejected' ) then 'rsp' when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ( 'as return' ,'resolution rejected' ) then 'rsp' when interaction_milestone = 'outbound transfer' and user_x in ('ar_escalator') then 'non-csa 1' when nvl(previous_assigned_group, '') in ('') and assigned_group in ('generic resource automation') then 'non-csa 2aa' when interaction_sequence_type in ( 'first action' ,'subsequent action' ) and user_x in ( 'aomaster' ,'aomaster1' ,'ar_escalator' ,'fuseadmin' ,'svc_rem_prd_tndpass' ) then 'non-csa 3' when nbn_technology = 'fttp' and prev_interaction_milestone in ( 'dispatched' ,'outbound transfer' ) then 'r&c' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'dispatched' then 'r&c 1' when interaction_milestone = 'pending' and prev_interaction_milestone = 'dispatched' then 'r&c 2' when interaction_milestone = 'pending' and upper(previous_assigned_group) not in ( 'nsoc' ,'fttp pa assurance tier 1' ,'hfc pa assurance tier 1' ,'csc-hfc ' ,'fttx pa assurance tier 1' ,'nhur - work rights' ,'fttx assurance tier1' ,'fttp assurance jeopardy tier 1' ,'hfc assurance jeopardy tier 1' ,'fttx assurance jeopardy tier 1' ) then 'non-csa 5' when interaction_milestone = 'pending' then 'dp&a' --- 'rule 1 – dp&a - 21/08/2017' --when interaction_milestone= 'inbound transfer' and upper(previous_assigned_group) like ('%ericsson%managed%') then 'rule added 15/8/2017 3 ericsson r&c' when interaction_milestone = 'outbound transfer' and upper(previous_assigned_group) in ( 'nsoc' ,'fttp pa assurance tier 1' ,'hfc pa assurance tier 1' ,'csc-hfc ' ,'fttx pa assurance tier 1' ,'nhur - work rights' ,'fttx assurance tier1' ,'fttp assurance jeopardy tier 1' ,'hfc assurance jeopardy tier 1' ,'fttx assurance jeopardy tier 1' ) then 'd&a' --when interaction_milestone in ( 'resolved' ) and prev_interaction_milestone in ('resolution rejected','pending') and upper(previous_assigned_group) like ('%ericsson%managed%') then 'rule ericsson-r&c' --when interaction_milestone in ('inbound transfer') then 'non-csa-2' when interaction_milestone = 'dispatched' then 'd&a' when interaction_milestone = 'outbound transfer' and prev_interaction_milestone in ( 'as return' ,'new' ,'outbound transfer' ,'pending' ,'resolution rejected' ) then 'd&a' when interaction_milestone = 'outbound transfer' /*and prev_interaction_milestone in ('in progress','inbound transfer')*/ then 'non-csa 3' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'resolution rejected' then 'd&a' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'automation queue' then 'r&c 3' when interaction_milestone = 'resolved' and prev_interaction_milestone = 'pending' and res_cat_3 in ( 'truck roll - cabling replaced' ,'truck roll - reconfigure' ,'truck roll - replaced' ,'truck roll - cabling re-terminated/ respliced' ,'as - end user unavailable' ,'truck roll - cabling refitted' ) then 'r&c 4' when incident_interaction_first_resolved_ts_local < incident_interaction_first_dispatched_ts_local and incident_interaction_first_resolved_ts_local is not null and incident_interaction_first_dispatched_ts_local is not null then 'd&a' when incident_interaction_first_dispatched_ts_local is null and interaction_milestone in ( 'inbound transfer' ,'new' ,/*'pending',*/ 'resolved' ) then 'd&a' --when incident_interaction_first_dispatched_ts_local is null and interaction_milestone in ('outbound transfer') then 'rule 4- non-csa' when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ( 'in progress' ,'inbound transfer' ,'new' ) then 'd&a' ---when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ('outbound transfer') then 'rule 5/6- non-csa' when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ('resolved') then 'r&c' --when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ('pending') and audit_date_local > incident_interaction_first_dispatched_ts_local then 'rule 5- r&c' --when incident_interaction_first_dispatched_ts_local is not null and interaction_milestone in ('pending') and audit_date_local <= incident_interaction_first_dispatched_ts_local then 'rule 6- d&a' when interaction_milestone in ('inbound transfer') then 'non-csa-4' else 'no l2 process' end as kaizen_l2_process_new",csa_tmp_inc_evnt_rmdy2110_v6
nbn_as_req_change,nbn_as_req,"trim(regexp_replace(nbn_as_req, 'nbn_as request description:|[\(\)]', ''))",csa_tmp_inc_evnt_rmdy2110_v4
nbn_enduser_engagement_type_change,nbn_enduser_engagement_type,"trim(regexp_replace(nbn_enduser_engagement_type, 'nbn_end user engagement type:|[0-9]|[\(\)]', ''))",csa_tmp_inc_evnt_rmdy2110_v4
nbn_reason_code,nbn_reason_code_position,cast(case when nbn_reason_code_position = 0 then null else regexp_substr(log_entries '[^\n]+' case when nbn_reason_code_position = 0 then 1 else nbn_reason_code_position end 1) end,csa_tmp_inc_evnt_rmdy2110_v3
nbn_resrej_accept_reason_change,nbn_resrej_accept_reason_change_init, case when nbn_resrej_accept_reason_ts_local <= next_rejection_decline_ts_local or next_rejection_decline_ts_local is null then nbn_resrej_accept_reason_change_init else null end,csa_tmp_inc_evnt_rmdy2110_v6
nbn_resrej_accept_reason_change,nbn_resrej_accept_reason_ts_local, case when nbn_resrej_accept_reason_ts_local <= next_rejection_decline_ts_local or next_rejection_decline_ts_local is null then nbn_resrej_accept_reason_change_init else null end,csa_tmp_inc_evnt_rmdy2110_v6
nbn_resrej_accept_reason_change,next_rejection_decline_ts_local, case when nbn_resrej_accept_reason_ts_local <= next_rejection_decline_ts_local or next_rejection_decline_ts_local is null then nbn_resrej_accept_reason_change_init else null end,csa_tmp_inc_evnt_rmdy2110_v6
nbn_resrej_code_change,nbn_resrej_code,"trim(regexp_replace(nbn_resrej_code, 'nbn_resolutionrejectioncode:|[\(\)]', ''))",csa_tmp_inc_evnt_rmdy2110_v4
nbn_resrej_comment_change,nbn_resrej_comment,"trim(regexp_replace(nbn_resrej_comment, 'nbn_resolution rejection comment:|[\(\)]', ''))",csa_tmp_inc_evnt_rmdy2110_v4
nbn_resrej_decline_code_change,nbn_resrej_decline_code,"trim(regexp_replace(nbn_resrej_decline_code, 'nbn_resolutionrejectiondeclinecode:|[\(\)]', ''))",csa_tmp_inc_evnt_rmdy2110_v4
nbn_resrej_decline_reason_change,nbn_resrej_decline_reason,"trim(regexp_replace(nbn_resrej_decline_reason, 'nbn_resolution rejection decline reason:|[\(\)]', ''))",csa_tmp_inc_evnt_rmdy2110_v4
nbn_resrej_reason_change,nbn_resrej_reason,"trim(regexp_replace(nbn_resrej_reason, 'nbn_resolution rejection reason:|[\(\)]', ''))",csa_tmp_inc_evnt_rmdy2110_v4
nbn_resrejdecline_comment_change,nbn_resrejdecline_comment,"trim(regexp_replace(nbn_resrejdecline_comment, 'nbn_resolution rejection decline comment:|[\(\)]', ''))",csa_tmp_inc_evnt_rmdy2110_v4
next_assigned_group_ts,assigned_group_change,"case when assigned_group_change is not null then lead(incident_assigned_group_ts_local) over ( partition by incident_key ,assigned_group_yn order by audit_date_local ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_assigned_group_ts,assigned_group_yn,"case when assigned_group_change is not null then lead(incident_assigned_group_ts_local) over ( partition by incident_key ,assigned_group_yn order by audit_date_local ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_assigned_group_ts,audit_date_local,"case when assigned_group_change is not null then lead(incident_assigned_group_ts_local) over ( partition by incident_key ,assigned_group_yn order by audit_date_local ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_assigned_group_ts,incident_assigned_group_ts_local,"case when assigned_group_change is not null then lead(incident_assigned_group_ts_local) over ( partition by incident_key ,assigned_group_yn order by audit_date_local ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_assigned_group_ts,incident_key,"case when assigned_group_change is not null then lead(incident_assigned_group_ts_local) over ( partition by incident_key ,assigned_group_yn order by audit_date_local ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_audit_date_aest_ts,audit_date_aest,"nvl(lead(audit_date_aest) over ( partition by incident_key order by audit_date_local,request_id asc ), case when incident_status = 'closed' then audit_date_local else null end )",csa_tmp_inc_evnt_rmdy2110_v6
next_audit_date_aest_ts,audit_date_local,"nvl(lead(audit_date_aest) over ( partition by incident_key order by audit_date_local,request_id asc ), case when incident_status = 'closed' then audit_date_local else null end )",csa_tmp_inc_evnt_rmdy2110_v6
next_audit_date_aest_ts,incident_key,"nvl(lead(audit_date_aest) over ( partition by incident_key order by audit_date_local,request_id asc ), case when incident_status = 'closed' then audit_date_local else null end )",csa_tmp_inc_evnt_rmdy2110_v6
next_audit_date_aest_ts,incident_status,"nvl(lead(audit_date_aest) over ( partition by incident_key order by audit_date_local,request_id asc ), case when incident_status = 'closed' then audit_date_local else null end )",csa_tmp_inc_evnt_rmdy2110_v6
next_audit_date_aest_ts,request_id,"nvl(lead(audit_date_aest) over ( partition by incident_key order by audit_date_local,request_id asc ), case when incident_status = 'closed' then audit_date_local else null end )",csa_tmp_inc_evnt_rmdy2110_v6
next_audit_date_local_ts,audit_date_local,"case when incident_status_change = 'resolved' then lead(audit_date_aest ) over (partition by incident_key order by case when incident_reason_change = 'resolution rejected by a.s' or incident_status_change = 'resolved' then audit_date_aest else null end nulls first ) else max(incident_resolution_rejected_ts_aest) over (partition by incident_key order by audit_date_aest rows between unbounded preceding and current row) end as running_max_resolution_rejected_update_ts_aest ,nvl(lead(audit_date_local) over ( partition by incident_key order by audit_date_local,request_id asc ), case when incident_status = 'closed' then audit_date_local else null end )",csa_tmp_inc_evnt_rmdy2110_v6
next_audit_date_local_ts,incident_key,"case when incident_status_change = 'resolved' then lead(audit_date_aest ) over (partition by incident_key order by case when incident_reason_change = 'resolution rejected by a.s' or incident_status_change = 'resolved' then audit_date_aest else null end nulls first ) else max(incident_resolution_rejected_ts_aest) over (partition by incident_key order by audit_date_aest rows between unbounded preceding and current row) end as running_max_resolution_rejected_update_ts_aest ,nvl(lead(audit_date_local) over ( partition by incident_key order by audit_date_local,request_id asc ), case when incident_status = 'closed' then audit_date_local else null end )",csa_tmp_inc_evnt_rmdy2110_v6
next_audit_date_local_ts,next_audit_date_local_ts,"case when incident_status_change = 'resolved' then lead(audit_date_aest ) over (partition by incident_key order by case when incident_reason_change = 'resolution rejected by a.s' or incident_status_change = 'resolved' then audit_date_aest else null end nulls first ) else max(incident_resolution_rejected_ts_aest) over (partition by incident_key order by audit_date_aest rows between unbounded preceding and current row) end as running_max_resolution_rejected_update_ts_aest ,nvl(lead(audit_date_local) over ( partition by incident_key order by audit_date_local,request_id asc ), case when incident_status = 'closed' then audit_date_local else null end )",csa_tmp_inc_evnt_rmdy2110_v6
next_audit_date_local_ts,request_id,"case when incident_status_change = 'resolved' then lead(audit_date_aest ) over (partition by incident_key order by case when incident_reason_change = 'resolution rejected by a.s' or incident_status_change = 'resolved' then audit_date_aest else null end nulls first ) else max(incident_resolution_rejected_ts_aest) over (partition by incident_key order by audit_date_aest rows between unbounded preceding and current row) end as running_max_resolution_rejected_update_ts_aest ,nvl(lead(audit_date_local) over ( partition by incident_key order by audit_date_local,request_id asc ), case when incident_status = 'closed' then audit_date_local else null end )",csa_tmp_inc_evnt_rmdy2110_v6
next_nbn_resrej_decline_code_change,audit_date_local,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(nbn_resrej_decline_code_change) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_nbn_resrej_decline_code_change,incident_key,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(nbn_resrej_decline_code_change) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_nbn_resrej_decline_code_change,incident_status_change,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(nbn_resrej_decline_code_change) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_nbn_resrej_decline_code_change,nbn_resrej_decline_code_change,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(nbn_resrej_decline_code_change) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_nbn_resrej_decline_reason_change,audit_date_local,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(nbn_resrej_decline_reason_change) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_nbn_resrej_decline_reason_change,incident_key,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(nbn_resrej_decline_reason_change) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_nbn_resrej_decline_reason_change,incident_status_change,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(nbn_resrej_decline_reason_change) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_nbn_resrej_decline_reason_change,nbn_resrej_decline_reason_change,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(nbn_resrej_decline_reason_change) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_nbn_resrejdecline_comment_change,audit_date_local,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(nbn_resrejdecline_comment_change) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_nbn_resrejdecline_comment_change,incident_key,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(nbn_resrejdecline_comment_change) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_nbn_resrejdecline_comment_change,incident_status_change,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(nbn_resrejdecline_comment_change) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_nbn_resrejdecline_comment_change,nbn_resrejdecline_comment_change,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(nbn_resrejdecline_comment_change) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_rejection_accept_ts_local,audit_date_local,",CASE WHEN nvl(INCIDENT_STATUS_CHANGE, 'null') = 'Resolved' AND next_status_tmp_local <> 'Resolved' THEN lead(audit_date_local) OVER ( PARTITION BY incident_key ,next_accept_10 ORDER BY audit_date_local ASC ) ELSE NULL END",csa_tmp_inc_evnt_rmdy2110_v7
next_rejection_accept_ts_local,incident_key,",CASE WHEN nvl(INCIDENT_STATUS_CHANGE, 'null') = 'Resolved' AND next_status_tmp_local <> 'Resolved' THEN lead(audit_date_local) OVER ( PARTITION BY incident_key ,next_accept_10 ORDER BY audit_date_local ASC ) ELSE NULL END",csa_tmp_inc_evnt_rmdy2110_v7
next_rejection_accept_ts_local,INCIDENT_STATUS_CHANGE,",CASE WHEN nvl(INCIDENT_STATUS_CHANGE, 'null') = 'Resolved' AND next_status_tmp_local <> 'Resolved' THEN lead(audit_date_local) OVER ( PARTITION BY incident_key ,next_accept_10 ORDER BY audit_date_local ASC ) ELSE NULL END",csa_tmp_inc_evnt_rmdy2110_v7
next_rejection_accept_ts_local,next_accept_10,",CASE WHEN nvl(INCIDENT_STATUS_CHANGE, 'null') = 'Resolved' AND next_status_tmp_local <> 'Resolved' THEN lead(audit_date_local) OVER ( PARTITION BY incident_key ,next_accept_10 ORDER BY audit_date_local ASC ) ELSE NULL END",csa_tmp_inc_evnt_rmdy2110_v7
next_rejection_accept_ts_local,next_status_tmp_local,",CASE WHEN nvl(INCIDENT_STATUS_CHANGE, 'null') = 'Resolved' AND next_status_tmp_local <> 'Resolved' THEN lead(audit_date_local) OVER ( PARTITION BY incident_key ,next_accept_10 ORDER BY audit_date_local ASC ) ELSE NULL END",csa_tmp_inc_evnt_rmdy2110_v7
next_rejection_accept_user_x,audit_date_local,"case when nvl(incident_status_change, 'null') = 'resolved' and next_status_tmp_local <> 'resolved' then lead(audit_date_local) over ( partition by incident_key ,next_accept_10 order by audit_date_local asc ) else null",csa_tmp_inc_evnt_rmdy2110_v7
next_rejection_accept_user_x,incident_key,"case when nvl(incident_status_change, 'null') = 'resolved' and next_status_tmp_local <> 'resolved' then lead(audit_date_local) over ( partition by incident_key ,next_accept_10 order by audit_date_local asc ) else null",csa_tmp_inc_evnt_rmdy2110_v7
next_rejection_accept_user_x,incident_status_change,"case when nvl(incident_status_change, 'null') = 'resolved' and next_status_tmp_local <> 'resolved' then lead(audit_date_local) over ( partition by incident_key ,next_accept_10 order by audit_date_local asc ) else null",csa_tmp_inc_evnt_rmdy2110_v7
next_rejection_accept_user_x,next_accept_10,"case when nvl(incident_status_change, 'null') = 'resolved' and next_status_tmp_local <> 'resolved' then lead(audit_date_local) over ( partition by incident_key ,next_accept_10 order by audit_date_local asc ) else null",csa_tmp_inc_evnt_rmdy2110_v7
next_rejection_accept_user_x,next_status_tmp_local,"case when nvl(incident_status_change, 'null') = 'resolved' and next_status_tmp_local <> 'resolved' then lead(audit_date_local) over ( partition by incident_key ,next_accept_10 order by audit_date_local asc ) else null",csa_tmp_inc_evnt_rmdy2110_v7
next_rejection_decline_ts_local,audit_date_local,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(audit_date_local) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_rejection_decline_ts_local,incident_key,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(audit_date_local) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_rejection_decline_ts_local,incident_status_change,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(audit_date_local) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_rejection_decline_user_x,audit_date_local,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(user_x) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_rejection_decline_user_x,incident_key,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(user_x) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_rejection_decline_user_x,incident_status_change,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(user_x) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_rejection_decline_user_x,user_x,"case when nvl(incident_status_change, 'null') = 'resolved' then lead(user_x) over ( partition by incident_key ,case when nvl(incident_status_change, 'null') = 'resolved' then 'y' else 'n' end order by audit_date_local asc ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_resolution_rejection_accept_decline_by,next_rejection_accept_user_xrejection_declined,case when rejection_declined = 'n' then next_rejection_accept_user_x when rejection_declined = 'y' then next_rejection_decline_user_x end,csa_tmp_inc_evnt_rmdy2110_v7
next_resolution_rejection_accept_decline_by,next_rejection_decline_user_x,case when rejection_declined = 'n' then next_rejection_accept_user_x when rejection_declined = 'y' then next_rejection_decline_user_x end,csa_tmp_inc_evnt_rmdy2110_v7
next_resolution_rejection_accept_decline_by,rejection_declined,case when rejection_declined = 'n' then next_rejection_accept_user_x when rejection_declined = 'y' then next_rejection_decline_user_x end,csa_tmp_inc_evnt_rmdy2110_v7
next_status_ts,audit_date_local,"case when incident_status_change is not null then lead(audit_date_local) over ( partition by incident_key ,incident_status_change order by audit_date_local ,incident_status_change nulls last ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_status_ts,incident_key,"case when incident_status_change is not null then lead(audit_date_local) over ( partition by incident_key ,incident_status_change order by audit_date_local ,incident_status_change nulls last ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
next_status_ts,incident_status_change,"case when incident_status_change is not null then lead(audit_date_local) over ( partition by incident_key ,incident_status_change order by audit_date_local ,incident_status_change nulls last ) else null end",csa_tmp_inc_evnt_rmdy2110_v6
otd_milestone,incident_milestone_1,case when incident_milestone_1 = 'assigned' and previous_incident_milestone_1 = 'access seeker update' then 'access seeker update assigned' when incident_milestone_1 = 'assigned' and previous_incident_milestone_1 = 'resolution rejected' then 'resolution rejected assigned' else incident_milestone_1 end,csa_tmp_inc_evnt_rmdy2110_v5
otd_milestone,previous_incident_milestone_1,case when incident_milestone_1 = 'assigned' and previous_incident_milestone_1 = 'access seeker update' then 'access seeker update assigned' when incident_milestone_1 = 'assigned' and previous_incident_milestone_1 = 'resolution rejected' then 'resolution rejected assigned' else incident_milestone_1 end,csa_tmp_inc_evnt_rmdy2110_v5
prev_interaction_audit_date_aest,audit_date_aest,"nvl(max(interaction_audit_date_aest) over ( partition by incident_key order by audit_date_aest rows between unbounded preceding and 1 preceding ), interaction_audit_date_aest)",csa_tmp_inc_evnt_rmdy2110_v6
prev_interaction_audit_date_aest,incident_key,"nvl(max(interaction_audit_date_aest) over ( partition by incident_key order by audit_date_aest rows between unbounded preceding and 1 preceding ), interaction_audit_date_aest)",csa_tmp_inc_evnt_rmdy2110_v6
prev_interaction_audit_date_aest,interaction_audit_date_aest,"nvl(max(interaction_audit_date_aest) over ( partition by incident_key order by audit_date_aest rows between unbounded preceding and 1 preceding ), interaction_audit_date_aest)",csa_tmp_inc_evnt_rmdy2110_v6
prev_interaction_audit_date_aest,partition,"nvl(max(interaction_audit_date_aest) over ( partition by incident_key order by audit_date_aest rows between unbounded preceding and 1 preceding ), interaction_audit_date_aest)",csa_tmp_inc_evnt_rmdy2110_v6
prev_interaction_audit_date_local,audit_date_local,"nvl(max(interaction_audit_date_local) over ( partition by incident_key order by audit_date_local rows between unbounded preceding and 1 preceding ), interaction_audit_date_local)",csa_tmp_inc_evnt_rmdy2110_v6
prev_interaction_audit_date_local,incident_key,"nvl(max(interaction_audit_date_local) over ( partition by incident_key order by audit_date_local rows between unbounded preceding and 1 preceding ), interaction_audit_date_local)",csa_tmp_inc_evnt_rmdy2110_v6
prev_interaction_audit_date_local,interaction_audit_date_local,"nvl(max(interaction_audit_date_local) over ( partition by incident_key order by audit_date_local rows between unbounded preceding and 1 preceding ), interaction_audit_date_local)",csa_tmp_inc_evnt_rmdy2110_v6
prev_interaction_milestone,AUDIT_DATE_LOCAL,"lag(INTERACTION_MILESTONE, 1) OVER ( PARTITION BY incident_key ,interaction_milestone_null_yn ORDER BY AUDIT_DATE_LOCAL ) ",csa_tmp_inc_evnt_rmdy2110_v5
prev_interaction_milestone,incident_key,"lag(INTERACTION_MILESTONE, 1) OVER ( PARTITION BY incident_key ,interaction_milestone_null_yn ORDER BY AUDIT_DATE_LOCAL ) ",csa_tmp_inc_evnt_rmdy2110_v5
prev_interaction_milestone,INTERACTION_MILESTONE,"lag(INTERACTION_MILESTONE, 1) OVER ( PARTITION BY incident_key ,interaction_milestone_null_yn ORDER BY AUDIT_DATE_LOCAL ) ",csa_tmp_inc_evnt_rmdy2110_v5
prev_interaction_milestone,interaction_milestone_null_yn,"lag(INTERACTION_MILESTONE, 1) OVER ( PARTITION BY incident_key ,interaction_milestone_null_yn ORDER BY AUDIT_DATE_LOCAL ) ",csa_tmp_inc_evnt_rmdy2110_v5
previous_assigned_group,assigned_group_change,"lag(assigned_group_change) over ( partition by incident_key ,assigned_group_yn order by audit_date_local asc )",csa_tmp_inc_evnt_rmdy2110_v5
previous_assigned_group,assigned_group_yn,"lag(assigned_group_change) over ( partition by incident_key ,assigned_group_yn order by audit_date_local asc )",csa_tmp_inc_evnt_rmdy2110_v5
previous_assigned_group,audit_date_local,"lag(assigned_group_change) over ( partition by incident_key ,assigned_group_yn order by audit_date_local asc )",csa_tmp_inc_evnt_rmdy2110_v5
previous_assigned_group,incident_key,"lag(assigned_group_change) over ( partition by incident_key ,assigned_group_yn order by audit_date_local asc )",csa_tmp_inc_evnt_rmdy2110_v5
previous_incident_status,audit_date_local,"lag(incident_status_change) over ( partition by incident_key ,incident_status_yn order by audit_date_local asc )",csa_tmp_inc_evnt_rmdy2110_v5
previous_incident_status,incident_key,"lag(incident_status_change) over ( partition by incident_key ,incident_status_yn order by audit_date_local asc )",csa_tmp_inc_evnt_rmdy2110_v5
previous_incident_status,incident_status_change,"lag(incident_status_change) over ( partition by incident_key ,incident_status_yn order by audit_date_local asc )",csa_tmp_inc_evnt_rmdy2110_v5
previous_incident_status,incident_status_yn,"lag(incident_status_change) over ( partition by incident_key ,incident_status_yn order by audit_date_local asc )",csa_tmp_inc_evnt_rmdy2110_v5
request_id,c1,c1,t2110
res_cat_3_change,res_cat_3,"trim(regexp_replace(res_cat_3, 'resolution category tier 3:|[\(\)]', ''))",csa_tmp_inc_evnt_rmdy2110_v4
res_cat_3,res_cat_3_position,cast(case when res_cat_3_position = 0 then null else regexp_substr(log_entries '[^\n]+' case when res_cat_3_position = 0 then 1 else res_cat_3_position end 1) end,csa_tmp_inc_evnt_rmdy2110_v3
resolution_category_change,resolution_category,"trim(regexp_replace(resolution_category, '|resolution category:|[0-9]|[\(\)]', ''))",csa_tmp_inc_evnt_rmdy2110_v4
resolution_rejected_date,audit_date_local,"case when incident_status_change = 'resolved' then lead(case when (incident_reason_change = 'resolution rejected by a.s' and nvl(nbn_resrej_code_change,'<blank>') <> '<blank>') or (incident_status_change = 'resolved' and nvl(nbn_resrej_code_change,'<blank>') <> '<blank>') then audit_date_local else null end) over ( partition by incident_key order by case when incident_reason_change = 'resolution rejected by a.s' or incident_status_change = 'resolved' then audit_date_local else null end ) else null end",csa_tmp_inc_evnt_rmdy2110_v7
resolution_rejected_date,incident_key,"case when incident_status_change = 'resolved' then lead(case when (incident_reason_change = 'resolution rejected by a.s' and nvl(nbn_resrej_code_change,'<blank>') <> '<blank>') or (incident_status_change = 'resolved' and nvl(nbn_resrej_code_change,'<blank>') <> '<blank>') then audit_date_local else null end) over ( partition by incident_key order by case when incident_reason_change = 'resolution rejected by a.s' or incident_status_change = 'resolved' then audit_date_local else null end ) else null end",csa_tmp_inc_evnt_rmdy2110_v7
resolution_rejected_date,incident_reason_change,"case when incident_status_change = 'resolved' then lead(case when (incident_reason_change = 'resolution rejected by a.s' and nvl(nbn_resrej_code_change,'<blank>') <> '<blank>') or (incident_status_change = 'resolved' and nvl(nbn_resrej_code_change,'<blank>') <> '<blank>') then audit_date_local else null end) over ( partition by incident_key order by case when incident_reason_change = 'resolution rejected by a.s' or incident_status_change = 'resolved' then audit_date_local else null end ) else null end",csa_tmp_inc_evnt_rmdy2110_v7
resolution_rejected_date,incident_status_change,"case when incident_status_change = 'resolved' then lead(case when (incident_reason_change = 'resolution rejected by a.s' and nvl(nbn_resrej_code_change,'<blank>') <> '<blank>') or (incident_status_change = 'resolved' and nvl(nbn_resrej_code_change,'<blank>') <> '<blank>') then audit_date_local else null end) over ( partition by incident_key order by case when incident_reason_change = 'resolution rejected by a.s' or incident_status_change = 'resolved' then audit_date_local else null end ) else null end",csa_tmp_inc_evnt_rmdy2110_v7
resolution_rejected_date,nbn_resrej_code_change,"case when incident_status_change = 'resolved' then lead(case when (incident_reason_change = 'resolution rejected by a.s' and nvl(nbn_resrej_code_change,'<blank>') <> '<blank>') or (incident_status_change = 'resolved' and nvl(nbn_resrej_code_change,'<blank>') <> '<blank>') then audit_date_local else null end) over ( partition by incident_key order by case when incident_reason_change = 'resolution rejected by a.s' or incident_status_change = 'resolved' then audit_date_local else null end ) else null end",csa_tmp_inc_evnt_rmdy2110_v7
running_max_access_seeker_update_ts_aest,audit_date_aest,max(incident_access_seeker_update_ts_aest) over (partition by incident_key order by audit_date_aest rows between unbounded preceding and current row ),csa_tmp_inc_evnt_rmdy2110_v6
running_max_access_seeker_update_ts_aest,incident_access_seeker_update_ts_aest,max(incident_access_seeker_update_ts_aest) over (partition by incident_key order by audit_date_aest rows between unbounded preceding and current row ),csa_tmp_inc_evnt_rmdy2110_v6
running_max_access_seeker_update_ts_aest,incident_key,max(incident_access_seeker_update_ts_aest) over (partition by incident_key order by audit_date_aest rows between unbounded preceding and current row ),csa_tmp_inc_evnt_rmdy2110_v6
running_max_assigned_group_ts_local,assigned_group_change,"max(incident_assigned_group_ts_local) over ( partition by incident_key order by audit_date_aest , assigned_group_change nulls last rows between unbounded preceding and current row )",csa_tmp_inc_evnt_rmdy2110_v6
running_max_assigned_group_ts_local,audit_date_aest,"max(incident_assigned_group_ts_local) over ( partition by incident_key order by audit_date_aest , assigned_group_change nulls last rows between unbounded preceding and current row )",csa_tmp_inc_evnt_rmdy2110_v6
running_max_assigned_group_ts_local,incident_assigned_group_ts_local,"max(incident_assigned_group_ts_local) over ( partition by incident_key order by audit_date_aest , assigned_group_change nulls last rows between unbounded preceding and current row )",csa_tmp_inc_evnt_rmdy2110_v6
running_max_assigned_group_ts_local,incident_key,"max(incident_assigned_group_ts_local) over ( partition by incident_key order by audit_date_aest , assigned_group_change nulls last rows between unbounded preceding and current row )",csa_tmp_inc_evnt_rmdy2110_v6
running_max_assigned_groupd_ts_aest,assigned_group_change,"max(incident_assigned_group_ts_aest) over ( partition by incident_key order by audit_date_aest,assigned_group_change nulls last rows between unbounded preceding and current row )",csa_tmp_inc_evnt_rmdy2110_v6
running_max_assigned_groupd_ts_aest,audit_date_aest,"max(incident_assigned_group_ts_aest) over ( partition by incident_key order by audit_date_aest,assigned_group_change nulls last rows between unbounded preceding and current row )",csa_tmp_inc_evnt_rmdy2110_v6
running_max_assigned_groupd_ts_aest,incident_assigned_group_ts_aest,"max(incident_assigned_group_ts_aest) over ( partition by incident_key order by audit_date_aest,assigned_group_change nulls last rows between unbounded preceding and current row )",csa_tmp_inc_evnt_rmdy2110_v6
running_max_assigned_groupd_ts_aest,incident_key,"max(incident_assigned_group_ts_aest) over ( partition by incident_key order by audit_date_aest,assigned_group_change nulls last rows between unbounded preceding and current row )",csa_tmp_inc_evnt_rmdy2110_v6
running_max_resolution_rejected_update_ts_aest,AUDIT_DATE_aest,ase when incident_status_change = 'Resolved' then lead(AUDIT_DATE_aest ) over (partition by incident_key order by case when incident_reason_change = 'Resolution Rejected By A.S' or incident_status_change = 'Resolved' then AUDIT_DATE_aest else null end nulls first ) else MAX(Incident_Resolution_Rejected_ts_AEST) OVER (PARTITION BY Incident_key ORDER BY audit_date_aest rows between unbounded preceding and current row) end ,0
running_max_resolution_rejected_update_ts_aest,audit_date_aest,ase when incident_status_change = 'Resolved' then lead(AUDIT_DATE_aest ) over (partition by incident_key order by case when incident_reason_change = 'Resolution Rejected By A.S' or incident_status_change = 'Resolved' then AUDIT_DATE_aest else null end nulls first ) else MAX(Incident_Resolution_Rejected_ts_AEST) OVER (PARTITION BY Incident_key ORDER BY audit_date_aest rows between unbounded preceding and current row) end ,0
running_max_resolution_rejected_update_ts_aest,incident_key,ase when incident_status_change = 'Resolved' then lead(AUDIT_DATE_aest ) over (partition by incident_key order by case when incident_reason_change = 'Resolution Rejected By A.S' or incident_status_change = 'Resolved' then AUDIT_DATE_aest else null end nulls first ) else MAX(Incident_Resolution_Rejected_ts_AEST) OVER (PARTITION BY Incident_key ORDER BY audit_date_aest rows between unbounded preceding and current row) end ,0
running_max_resolution_rejected_update_ts_aest,Incident_key,ase when incident_status_change = 'Resolved' then lead(AUDIT_DATE_aest ) over (partition by incident_key order by case when incident_reason_change = 'Resolution Rejected By A.S' or incident_status_change = 'Resolved' then AUDIT_DATE_aest else null end nulls first ) else MAX(Incident_Resolution_Rejected_ts_AEST) OVER (PARTITION BY Incident_key ORDER BY audit_date_aest rows between unbounded preceding and current row) end ,0
running_max_resolution_rejected_update_ts_aest,incident_reason_change,ase when incident_status_change = 'Resolved' then lead(AUDIT_DATE_aest ) over (partition by incident_key order by case when incident_reason_change = 'Resolution Rejected By A.S' or incident_status_change = 'Resolved' then AUDIT_DATE_aest else null end nulls first ) else MAX(Incident_Resolution_Rejected_ts_AEST) OVER (PARTITION BY Incident_key ORDER BY audit_date_aest rows between unbounded preceding and current row) end ,0
running_max_resolution_rejected_update_ts_aest,Incident_Resolution_Rejected_ts_AEST,ase when incident_status_change = 'Resolved' then lead(AUDIT_DATE_aest ) over (partition by incident_key order by case when incident_reason_change = 'Resolution Rejected By A.S' or incident_status_change = 'Resolved' then AUDIT_DATE_aest else null end nulls first ) else MAX(Incident_Resolution_Rejected_ts_AEST) OVER (PARTITION BY Incident_key ORDER BY audit_date_aest rows between unbounded preceding and current row) end ,0
running_max_resolution_rejected_update_ts_aest,incident_status_change,ase when incident_status_change = 'Resolved' then lead(AUDIT_DATE_aest ) over (partition by incident_key order by case when incident_reason_change = 'Resolution Rejected By A.S' or incident_status_change = 'Resolved' then AUDIT_DATE_aest else null end nulls first ) else MAX(Incident_Resolution_Rejected_ts_AEST) OVER (PARTITION BY Incident_key ORDER BY audit_date_aest rows between unbounded preceding and current row) end ,0
running_max_resolved_ts_aest,audit_date_aest,max(incident_resolved_ts_aest) over ( partition by incident_key order by audit_date_aest rows between unbounded preceding and current row ),csa_tmp_inc_evnt_rmdy2110_v6
running_max_resolved_ts_aest,incident_key,max(incident_resolved_ts_aest) over ( partition by incident_key order by audit_date_aest rows between unbounded preceding and current row ),csa_tmp_inc_evnt_rmdy2110_v6
running_max_resolved_ts_aest,incident_resolved_ts_aest,max(incident_resolved_ts_aest) over ( partition by incident_key order by audit_date_aest rows between unbounded preceding and current row ),csa_tmp_inc_evnt_rmdy2110_v6
running_max_resolved_ts_local,audit_date_aest,max(incident_resolved_ts_local) over ( partition by incident_key order by audit_date_aest rows between unbounded preceding and current row ),csa_tmp_inc_evnt_rmdy2110_v6
running_max_resolved_ts_local,incident_key,max(incident_resolved_ts_local) over ( partition by incident_key order by audit_date_aest rows between unbounded preceding and current row ),csa_tmp_inc_evnt_rmdy2110_v6
running_max_resolved_ts_local,incident_resolved_ts_local,max(incident_resolved_ts_local) over ( partition by incident_key order by audit_date_aest rows between unbounded preceding and current row ),csa_tmp_inc_evnt_rmdy2110_v6
running_max_status_ts_aest,audit_date_aest,"max(incident_status_ts_aest) over ( partition by incident_key order by audit_date_aest,incident_status_change desc nulls last rows between unbounded preceding and current row )",csa_tmp_inc_evnt_rmdy2110_v6
running_max_status_ts_aest,incident_key,"max(incident_status_ts_aest) over ( partition by incident_key order by audit_date_aest,incident_status_change desc nulls last rows between unbounded preceding and current row )",csa_tmp_inc_evnt_rmdy2110_v6
running_max_status_ts_aest,incident_status_change,"max(incident_status_ts_aest) over ( partition by incident_key order by audit_date_aest,incident_status_change desc nulls last rows between unbounded preceding and current row )",csa_tmp_inc_evnt_rmdy2110_v6
running_max_status_ts_aest,incident_status_ts_aest,"max(incident_status_ts_aest) over ( partition by incident_key order by audit_date_aest,incident_status_change desc nulls last rows between unbounded preceding and current row )",csa_tmp_inc_evnt_rmdy2110_v6
running_max_status_ts_local,audit_date_aest,"max(incident_status_ts_local) over ( partition by incident_key order by audit_date_aest, incident_status_change desc nulls last rows between unbounded preceding and current row )",csa_tmp_inc_evnt_rmdy2110_v6
running_max_status_ts_local,incident_key,"max(incident_status_ts_local) over ( partition by incident_key order by audit_date_aest, incident_status_change desc nulls last rows between unbounded preceding and current row )",csa_tmp_inc_evnt_rmdy2110_v6
running_max_status_ts_local,incident_status_change,"max(incident_status_ts_local) over ( partition by incident_key order by audit_date_aest, incident_status_change desc nulls last rows between unbounded preceding and current row )",csa_tmp_inc_evnt_rmdy2110_v6
running_max_status_ts_local,incident_status_ts_local,"max(incident_status_ts_local) over ( partition by incident_key order by audit_date_aest, incident_status_change desc nulls last rows between unbounded preceding and current row )",csa_tmp_inc_evnt_rmdy2110_v6
site_id,,source table,gns_vwfm_agentadherencetotal_v
sitename,,source table,gns_vwfm_agentadherencetotal_v
team_id,,source table,gns_vwfm_agentadherencetotal_v
teamname,,source table,gns_vwfm_agentadherencetotal_v
user_x,c455,c455,t2110
inc evnt status check seq,incident_status_check_seq,target table,csa_inc_evnt_rmdy2110_t
incident key,incident_key,target table,csa_inc_evnt_rmdy2110_t
inc evnt primary key,primary_key,target table,csa_inc_evnt_rmdy2110_t
inc evnt number id,incident_number_id,target table,csa_inc_evnt_rmdy2110_t
inc evnt request id,request_id,target table,csa_inc_evnt_rmdy2110_t
inc evnt start ts,audit_date_local,target table,csa_inc_evnt_rmdy2110_t
inc evnt start ts aest,audit_date_aest,target table,csa_inc_evnt_rmdy2110_t
inc evnt start ts utc,audit_date_utc,target table,csa_inc_evnt_rmdy2110_t
inc evnt user x,user_x,target table,csa_inc_evnt_rmdy2110_t
inc evnt reason change,incident_reason_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt industry status change,incident_industry_status_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt status change,incident_status_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt assigned group change,assigned_group_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt assignee change,assignee_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt resolution category change,resolution_category_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt industry sub status change,industry_sub_status_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt assigned support company change,assigned_support_company_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt status,incident_status,target table,csa_inc_evnt_rmdy2110_t
inc evnt assigned group,assigned_group,target table,csa_inc_evnt_rmdy2110_t
inc evnt assigned support company,assigned_support_company,target table,csa_inc_evnt_rmdy2110_t
previous inc evnt status,previous_incident_status,target table,csa_inc_evnt_rmdy2110_t
inc evnt previous assigned group,previous_assigned_group,target table,csa_inc_evnt_rmdy2110_t
inc evnt otd milestone,otd_milestone,target table,csa_inc_evnt_rmdy2110_t
inc evnt otd pended ts aest,incident_pended_ts_aest,target table,csa_inc_evnt_rmdy2110_t
inc evnt otd resolved ts aest,incident_resolved_ts_aest,target table,csa_inc_evnt_rmdy2110_t
inc evnt otd dispatched ts aest,incident_dispatched_ts_aest,target table,csa_inc_evnt_rmdy2110_t
inc evnt otd pended ts,incident_pended_ts_local,target table,csa_inc_evnt_rmdy2110_t
inc evnt otd resolved ts,incident_resolved_ts_local,target table,csa_inc_evnt_rmdy2110_t
inc evnt otd dispatched ts,incident_dispatched_ts_local,target table,csa_inc_evnt_rmdy2110_t
inc evnt otd access seeker update ts aest,incident_access_seeker_update_ts_aest,target table,csa_inc_evnt_rmdy2110_t
inc evnt otd resolution rejected ts aest,incident_resolution_rejected_ts_aest,target table,csa_inc_evnt_rmdy2110_t
inc evnt otd closed ts aest,incident_closed_ts_aest,target table,csa_inc_evnt_rmdy2110_t
inc evnt otd closed ts,incident_closed_ts_local,target table,csa_inc_evnt_rmdy2110_t
inc evnt otd closed ts utc,incident_closed_ts_utc,target table,csa_inc_evnt_rmdy2110_t
inc evnt otd run max access seeker update ts aest,running_max_access_seeker_update_ts_aest,target table,csa_inc_evnt_rmdy2110_t
inc evnt otd run max resolved ts aest,running_max_resolved_ts_aest,target table,csa_inc_evnt_rmdy2110_t
inc evnt otd run max resolved ts local,running_max_resolved_ts_local,target table,csa_inc_evnt_rmdy2110_t
inc evnt otd run max resolution rejected update ts aest,running_max_resolution_rejected_update_ts_aest,target table,csa_inc_evnt_rmdy2110_t
inc evnt interaction milestone,interaction_milestone,target table,csa_inc_evnt_rmdy2110_t
inc evnt end ts,next_audit_date_local_ts,target table,csa_inc_evnt_rmdy2110_t
inc evnt end aest ts,next_audit_date_aest_ts,target table,csa_inc_evnt_rmdy2110_t
inc evnt next status ts,next_status_ts,target table,csa_inc_evnt_rmdy2110_t
inc evnt next assigned group ts,next_assigned_group_ts,target table,csa_inc_evnt_rmdy2110_t
inc evnt interaction sequence type,interaction_sequence_type,target table,csa_inc_evnt_rmdy2110_t
inc envt interaction sequence,interaction_sequence,target table,csa_inc_evnt_rmdy2110_t
inc evnt previous interaction ts,prev_interaction_audit_date_local,target table,csa_inc_evnt_rmdy2110_t
inc evnt kaizen l2 process,kaizen_l2_process_test,target table,csa_inc_evnt_rmdy2110_t
inc evnt kaizen l2 process new,kaizen_l2_process_new,target table,csa_inc_evnt_rmdy2110_t
inc evnt previous interaction milestone,prev_interaction_milestone,target table,csa_inc_evnt_rmdy2110_t
inc evnt resolution category tier 3 change,res_cat_3_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt resolution category tier 3,res_cat_3,target table,csa_inc_evnt_rmdy2110_t
inc evnt access seeker pending reason,nbn_as_req_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt rejected ts local,resolution_rejected_date,target table,csa_inc_evnt_rmdy2110_t
inc evnt assignee,assignee,target table,csa_inc_evnt_rmdy2110_t
inc evnt assignee change date,assignee_change_date,target table,csa_inc_evnt_rmdy2110_t
inc evnt incident status aest ts,incident_status_ts_aest,target table,csa_inc_evnt_rmdy2110_t
inc evnt incident status local ts,incident_status_ts_local,target table,csa_inc_evnt_rmdy2110_t
inc evnt assigned group aest ts,incident_assigned_group_ts_aest,target table,csa_inc_evnt_rmdy2110_t
inc evnt assigned group local ts,incident_assigned_group_ts_local,target table,csa_inc_evnt_rmdy2110_t
inc evnt run max status aest ts,running_max_status_ts_aest,target table,csa_inc_evnt_rmdy2110_t
inc evnt run max status local ts,running_max_status_ts_local,target table,csa_inc_evnt_rmdy2110_t
inc evnt run max assigned group aest ts,running_max_assigned_groupd_ts_aest,target table,csa_inc_evnt_rmdy2110_t
inc evnt run max assigned group local ts,running_max_assigned_group_ts_local,target table,csa_inc_evnt_rmdy2110_t
inc evnt resolution rejection code,nbn_resrej_code_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt resolution rejection reason,nbn_resrej_reason_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt resolution rejection decline code,nbn_resrej_decline_code_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt resolution rejection decline reason,nbn_resrej_decline_reason_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt resolution rejection comment,nbn_resrej_comment_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt resolution rejection decline comment,nbn_resrejdecline_comment_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt accepted ts aest,incident_accepted_ts_aest,target table,csa_inc_evnt_rmdy2110_t
inc evnt accepted ts local,incident_accepted_ts_local,target table,csa_inc_evnt_rmdy2110_t
inc evnt next resolution rejection decline reason,next_nbn_resrej_decline_reason_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt next resolution rejection decline code,next_nbn_resrej_decline_code_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt next resolution rejection decline comment,next_nbn_resrejdecline_comment_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt next resolution rejection decline ts local,next_rejection_decline_ts_local,target table,csa_inc_evnt_rmdy2110_t
inc evnt next resolution rejection decline user,next_rejection_decline_user_x,target table,csa_inc_evnt_rmdy2110_t
inc evnt next resolution rejection accept ts,next_rejection_accept_ts_local,target table,csa_inc_evnt_rmdy2110_t
inc evnt next resolution rejection accept user,next_rejection_accept_user_x,target table,csa_inc_evnt_rmdy2110_t
inc evnt end user engagement type change,nbn_enduser_engagement_type_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt previous interaction ts aest,prev_interaction_audit_date_aest,target table,csa_inc_evnt_rmdy2110_t
inc evnt resolution rejection accept reason,nbn_resrej_accept_reason_change,target table,csa_inc_evnt_rmdy2110_t
inc evnt next resolution rejection accepted/declined by,next_resolution_rejection_accept_decline_by,target table,csa_inc_evnt_rmdy2110_t
gns accepted/declined by agent id,agent_id,target table,csa_inc_evnt_rmdy2110_t
gns accepted/declined by agent name,agentname,target table,csa_inc_evnt_rmdy2110_t
gns accepted/declined by site id,site_id,target table,csa_inc_evnt_rmdy2110_t
gns accepted/declined by site name,sitename,target table,csa_inc_evnt_rmdy2110_t
gns accepted/declined by team id,team_id,target table,csa_inc_evnt_rmdy2110_t
gns accepted/declined by team name,teamname,target table,csa_inc_evnt_rmdy2110_t
inc evnt nbn reason code,nbn_reason_code,target table,csa_inc_evnt_rmdy2110_t
action,c454,source table,t2110
audit_date,c452,source table,t2110
create_date,c3,source table,t2110
fields_changed,c456,source table,t2110
form_name,c457,source table,t2110
guid_field,c458,source table,t2110
last_modified_by,c5,source table,t2110
log_entries,c459,source table,t2110
log_key_1,c460,source table,t2110
modified_date,c6,source table,t2110
original_request_id,c450,source table,t2110
request_id,c1,source table,t2110
short_description,c8,source table,t2110
status,c7,source table,t2110
submitter,c2,source table,t2110
user_x,c455,source table,t2110
next_field_resrej_comment_position,fields_changed,"case when regexp_instr(fields_changed, 'nbn_resolution rejection comment') =0 then 1 else regexp_instr(fields_changed, 'nbn_resolution rejection comment') +length('nbn_resolution rejection comment')+1 end",csa_tmp_inc_evnt_rmdy2110_v1
next_field_resrej_comment_position,fields_changed,"case when regexp_instr(fields_changed, 'nbn_resolution rejection decline comment') =0 then 1 else regexp_instr(fields_changed, 'nbn_resolution rejection decline comment') +length('nbn_resolution rejection decline comment')+1 end `",csa_tmp_inc_evnt_rmdy2110_v1
incident_reason_position,log_entries,regexp_instr(log_entries 'status_reason' 1),csa_tmp_inc_evnt_rmdy2110_v2
industry_status_position,log_entries,regexp_instr(log_entries 'industry status' 1),csa_tmp_inc_evnt_rmdy2110_v2
assigned_group_position,log_entries,regexp_instr(log_entries 'assigned group'),csa_tmp_inc_evnt_rmdy2110_v2
industry_sub_status_position,log_entries,regexp_instr(log_entries 'industry sub status'),csa_tmp_inc_evnt_rmdy2110_v2
assignee_position,log_entries,regexp_instr(log_entries 'assignee'),csa_tmp_inc_evnt_rmdy2110_v2
resolution_category_position,log_entries,regexp_instr(log_entries 'resolution category:'),csa_tmp_inc_evnt_rmdy2110_v2
assigned_support_company_position,log_entries,regexp_instr(log_entries 'assigned support company'),csa_tmp_inc_evnt_rmdy2110_v2
last_resolved_date_position,log_entries,regexp_instr(log_entries 'last resolved date'),csa_tmp_inc_evnt_rmdy2110_v2
res_cat_3_position,log_entries,regexp_instr(log_entries 'resolution category tier 3:'),csa_tmp_inc_evnt_rmdy2110_v2
nbn_as_req_position,log_entries,regexp_instr(log_entries 'nbn_as request description:'),csa_tmp_inc_evnt_rmdy2110_v2
nbn_reason_code_position,log_entries,regexp_instr(log_entries 'nbn_reason code:'),csa_tmp_inc_evnt_rmdy2110_v2
status_position,log_entries,case when substring(log_entries 1 7) = 'status:' then regexp_instr(log_entries 'status:' 1) else regexp_instr(log_entries chr(10) || 'status:' 1) end,csa_tmp_inc_evnt_rmdy2110_v2
nbn_resrejectioncode_position,log_entries,regexp_instr(log_entries 'nbn_resolutionrejectioncode'),csa_tmp_inc_evnt_rmdy2110_v2
nbn_resrejectionreason_position,log_entries,regexp_instr(log_entries 'nbn_resolution rejection reason'),csa_tmp_inc_evnt_rmdy2110_v2
nbn_resrejectiondeclinecode_position,log_entries,regexp_instr(log_entries 'nbn_resolutionrejectiondeclinecode'),csa_tmp_inc_evnt_rmdy2110_v2
nbn_resrejdeclinereason_position,log_entries,regexp_instr(log_entries 'nbn_resolution rejection decline reason'),csa_tmp_inc_evnt_rmdy2110_v2
nbn_resrej_comment_position,log_entries,regexp_instr(log_entries 'nbn_resolution rejection comment'),csa_tmp_inc_evnt_rmdy2110_v2
nbn_resrejdecline_comment_position,log_entries,regexp_instr(log_entries 'nbn_resolution rejection decline comment'),csa_tmp_inc_evnt_rmdy2110_v2
nbn_enduser_engagement_type_position,log_entries,regexp_instr(log_entries 'nbn_end user engagement type'),csa_tmp_inc_evnt_rmdy2110_v2
nbn_resrejacceptreason_position,log_entries,regexp_instr(log_entries 'nbn_resolutionrejectionacceptreason'),csa_tmp_inc_evnt_rmdy2110_v2
end_position_resrej_comment,next_field_name_resrej_comment,case when next_field_name_resrej_comment is null then 0 else position(next_field_name_resrej_comment in log_entries ) end,csa_tmp_inc_evnt_rmdy2110_v2
end_position_resrej_comment,log_entries,case when next_field_name_resrej_comment is null then 0 else position(next_field_name_resrej_comment in log_entries ) end,csa_tmp_inc_evnt_rmdy2110_v2
end_position_resrej_decline_comment,next_field_name_resrej_decline_comment,case when next_field_name_resrej_decline_comment is null then 0 else position (next_field_name_resrej_decline_comment in log_entries ) end,csa_tmp_inc_evnt_rmdy2110_v2
end_position_resrej_decline_comment,log_entries,case when next_field_name_resrej_decline_comment is null then 0 else position (next_field_name_resrej_decline_comment in log_entries ) end,csa_tmp_inc_evnt_rmdy2110_v2
incident_reason,incident_reason_positioin,cast(case when incident_reason_position = 0 then null else regexp_substr(log_entries '[^\n]+' case when incident_reason_position = 0 then 1 else incident_reason_position end 1) end,csa_tmp_inc_evnt_rmdy2110_v3
incident_reason,log_entries,,
